library(extRemes)
library(in2extRemes)
in2extRemes()
()
library(extRemes)
library(in2extRemes)
in2extRemes()
"portpirie"<-
structure(.Data = list(Year = c(1923, 1924, 1925, 1926, 1927, 1928, 1929, 1930,
1931, 1932, 1933, 1934, 1935, 1936, 1937, 1938, 1939, 1940, 1941, 1942,
1943, 1944, 1945, 1946, 1947, 1948, 1949, 1950, 1951, 1952, 1953, 1954,
1955, 1956, 1957, 1958, 1959, 1960, 1961, 1962, 1963, 1964, 1965, 1966,
1967, 1968, 1969, 1970, 1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978,
1979, 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987), "SeaLevel" = c(
4.03, 3.83, 3.65, 3.88, 4.01, 4.08, 4.18, 3.8, 4.36, 3.96, 3.98, 4.69,
3.85, 3.96, 3.85, 3.93, 3.75, 3.63, 3.57, 4.25, 3.97, 4.05, 4.24, 4.22,
3.73, 4.37, 4.06, 3.71, 3.96, 4.06, 4.55, 3.79, 3.89, 4.11, 3.85, 3.86,
3.86, 4.21, 4.01, 4.11, 4.24, 3.96, 4.21, 3.74, 3.85, 3.88, 3.66, 4.11,
3.71, 4.18, 3.9, 3.78, 3.91, 3.72, 4, 3.66, 3.62, 4.33, 4.55, 3.75,
4.08, 3.9, 3.88, 3.94, 4.33)), class = "data.frame", row.names = c("1",
"2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14",
"15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26",
"27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38",
"39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50",
"51", "52", "53", "54", "55", "56", "57", "58", "59", "60", "61", "62",
"63", "64", "65"))
portpirie
load(portpirie)
solve(portpirie$models$fit1$hessian)
solve(portpirie$models$fit1$results$hessian)
solve(-1*portpirie$models$fit1$results$hessian)
sqrt(solve(portpirie$models$fit1$results$hessian))
solve(portpirie$models$fit1$results$hessian)
solve(portpirie$models$fit2$results$hessian)
sqrt(solve(portpirie$models$fit2$results$hessian))
sqrt(0.0006499383)
solve(-1*portpirie$models$fit2$results$hessian)
fisher = -portpirie$models$fit2$results$hessian
fisher
solve(fisher)
hello
hej
P = unname(portpirie$models$fit1$results$par)
z0 = P[1]-P[2]/P[3]
del0 = matrix(ncol=1,nrow=3)
del0[1] = 1
del0[2] = -(P[3]^-1)
del0[3] = P[2]*(P[3]^-2)
var0 = t(del0)%*%V%*%del0
ci0 = c(z0-1.96*sqrt(var0),z0+1.96*sqrt(var0))
var10 = t(del10)%*%V%*%del10
y100=-log(1-(1/100))
del100 = matrix(ncol=1,nrow=3)
del100[1,1] = 1
del100[2,1] = -((P[3])^(-1))*(1-(y100^(-P[3])))
del100[3,1]=((P[2])*((P[3])^(-2))*(1-((y100)^(-P[3]))))-
((P[2])*((P[3])^(-1))*((y100)^(-(P[3])))*log(y100))
var100 = t(del100)%*%V%*%del100
z10 = P[1] - (P[2]/P[3])*(1-(y10)^(-P[3]))
z100 = P[1] - (P[2]/P[3])*(1-(y100)^(-P[3]))
ci10 = c(z10-1.96*sqrt(var10),z10+1.96*sqrt(var10))
ci100 = c(z100-1.96*sqrt(var100),z100+1.96*sqrt(var100))
z0 = P[1]-P[2]/P[3]
del0 = matrix(ncol=1,nrow=3)
del0[1] = 1
del0[2] = -(P[3]^-1)
del0[3] = P[2]*(P[3]^-2)
var0 = t(del0)%*%V%*%del0
ci0 = c(z0-1.96*sqrt(var0),z0+1.96*sqrt(var0))
V = unname(solve(portpirie$models$fit1$results$hessian))
P = unname(portpirie$models$fit1$results$par)
y10 = -log(1-(1/10))
del10 = matrix(ncol=1,nrow=3)
del10[1,1] = 1
del10[2,1] = -((P[3])^(-1))*(1-(y10^(-P[3])))
del10[3,1]=((P[2])*((P[3])^(-2))*(1-((y10)^(-P[3]))))-
((P[2])*((P[3])^(-1))*((y10)^(-(P[3])))*log(y10))
var10 = t(del10)%*%V%*%del10
y100=-log(1-(1/100))
del100 = matrix(ncol=1,nrow=3)
del100[1,1] = 1
del100[2,1] = -((P[3])^(-1))*(1-(y100^(-P[3])))
del100[3,1]=((P[2])*((P[3])^(-2))*(1-((y100)^(-P[3]))))-
((P[2])*((P[3])^(-1))*((y100)^(-(P[3])))*log(y100))
var100 = t(del100)%*%V%*%del100
z10 = P[1] - (P[2]/P[3])*(1-(y10)^(-P[3]))
z100 = P[1] - (P[2]/P[3])*(1-(y100)^(-P[3]))
ci10 = c(z10-1.96*sqrt(var10),z10+1.96*sqrt(var10))
ci100 = c(z100-1.96*sqrt(var100),z100+1.96*sqrt(var100))
z0 = P[1]-P[2]/P[3]
del0 = matrix(ncol=1,nrow=3)
del0[1] = 1
del0[2] = -(P[3]^-1)
del0[3] = P[2]*(P[3]^-2)
var0 = t(del0)%*%V%*%del0
ci0 = c(z0-1.96*sqrt(var0),z0+1.96*sqrt(var0))
ci0
z0
z0
ci0
solve(portpirie$models$fit2$results$hessian)
c <-solve(portpirie$models$fit2$results$hessian)
sqrt(c)
1.96*0.02549389
3.8694436-0.04996802
